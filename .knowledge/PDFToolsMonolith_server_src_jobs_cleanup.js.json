{"is_source_file": true, "format": "JavaScript", "description": "This file defines an asynchronous script for cleaning up old files in a specified output directory based on a TTL (time-to-live) value. It reads environment variables, interacts with the filesystem to list files, check modification times, and delete files older than a certain cutoff.", "external_files": ["../utils/fsutil.js"], "external_methods": ["fs.readdir", "fs.stat", "fs.unlink", "console.log", "console.error", "process.exit", "dayjs"], "published": [], "classes": [], "methods": [{"name": "anonymous async function", "description": "Main execution function that performs the cleanup operation."}], "calls": ["fs.readdir", "fs.stat", "fs.unlink", "console.log", "console.error", "process.exit", "dayjs"], "search-terms": ["cleanup", "file deletion", "ttl", "public download", "stats", "async script"], "state": 2, "file_id": 27, "knowledge_revision": 54, "git_revision": "", "ctags": [{"_type": "tag", "name": "cutoff", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^    const cutoff = dayjs().subtract(ttlHours * 2, 'hour'); \\/\\/ keep a bit longer$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "deleted", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^    let deleted = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "files", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^    const files = await fs.readdir(OUTPUTS_DIR);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^      const p = path.join(OUTPUTS_DIR, f);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^      const st = await fs.stat(p);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ttlHours", "path": "/home/kavia/workspace/code-generation/pdf-tools-12948-12989/PDFToolsMonolith/server/src/jobs/cleanup.js", "pattern": "/^    const ttlHours = parseInt(process.env.PUBLIC_DOWNLOAD_TTL_HOURS || '24', 10);$/", "language": "JavaScript", "kind": "constant"}], "hash": "6703863f2747fb9934faa732d9b8ce29", "format-version": 4, "code-base-name": "PDFToolsMonolith", "filename": "PDFToolsMonolith/server/src/jobs/cleanup.js", "fields": [{"name": "let deleted = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"54": ""}]}